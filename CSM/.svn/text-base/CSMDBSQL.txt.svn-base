CREATE TABLE CONTEXT (
  ID CHAR(38) NOT NULL,
  NAME VARCHAR(45) NULL,
  DESCRIPTION TEXT NULL,
  PARENTID CHAR(38) NOT NULL,
  PRIMARY KEY(ID)
)
TYPE=InnoDB;

CREATE TABLE CSMUSER (
  ID CHAR(38) NOT NULL,
  CONTEXT_ID CHAR(38) NOT NULL,
  NAME VARCHAR(60) NOT NULL,
  DESCRIPTION TEXT NULL,
  CSMUSERNAME VARCHAR(15) NOT NULL,
  USERPROFILEID CHAR(38) BINARY NOT NULL,
  LASTLOGIN DATETIME NULL,
  FL_ACTIVE   BOOL NULL,
  CREATEDAT DATETIME NOT NULL,
  CREATEDBY DATETIME NOT NULL,
  PRIMARY KEY(ID),
  INDEX CSMUSER_FKIndex1(CONTEXT_ID),
  FOREIGN KEY(CONTEXT_ID)
    REFERENCES CONTEXT(ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION
)
TYPE=InnoDB;

CREATE TABLE CONTACT (
  ID CHAR(38) NOT NULL,
  CSMUSER_ID CHAR(38) NOT NULL,
  AREA VARCHAR(60) NULL,
  PHONE VARCHAR(60) NULL,
  MOBILE VARCHAR(60) NULL,
  EMAIL VARCHAR(60) NULL,
  PRIMARY KEY(ID),
  INDEX CONTACT_FKIndex1(CSMUSER_ID),
  FOREIGN KEY(CSMUSER_ID)
    REFERENCES CSMUSER(ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION
)
TYPE=InnoDB;

CREATE TABLE USERACCESSCONTROL (
  ID CHAR(38) NOT NULL,
  CSMUSER_ID CHAR(38) NOT NULL,
  USERPASSWORD CHAR(32) NULL,
  EXPIRATIONDATE DATE NULL,
  LASTCHANGEDATE DATE NULL,
  FL_CHANGENEXTLOGIN BOOL NULL,
  PRIMARY KEY(ID),
  INDEX USERACCESSCONTROL_FKIndex1(CSMUSER_ID),
  FOREIGN KEY(CSMUSER_ID)
    REFERENCES CSMUSER(ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION
)
TYPE=InnoDB;




-----------------------------------------------------------------------------



CREATE TABLE CSMDEVICE (
  ID CHAR(38) NOT NULL,
  CONTEXT_ID CHAR(38) NOT NULL,
  NAME VARCHAR(60) NOT NULL,
  DESCRIPTION TEXT NULL,
  PRIMARY KEY(ID),
  INDEX CSMDEVICE_FKIndex1(CONTEXT_ID),
  FOREIGN KEY(CONTEXT_ID)
    REFERENCES CONTEXT(ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION
)
TYPE=InnoDB;

CREATE TABLE USERPROFDEVICEDENIED (
  PRFID CHAR(38) NOT NULL,
  CSMDEVICE_ID CHAR(38) NOT NULL,
  USERPROFILE_CSMUSER_ID CHAR(38) NOT NULL,
  USERPROFILE_ID CHAR(38) NOT NULL,
  PRIMARY KEY(PRFID),
  INDEX USERPROFDEVICEDENIED_FKIndex1(USERPROFILE_ID, USERPROFILE_CSMUSER_ID),
  INDEX USERPROFDEVICEDENIED_FKIndex2(CSMDEVICE_ID),
  FOREIGN KEY(USERPROFILE_ID, USERPROFILE_CSMUSER_ID)
    REFERENCES USERPROFILE(ID, CSMUSER_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION,
  FOREIGN KEY(CSMDEVICE_ID)
    REFERENCES CSMDEVICE(ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION
)
TYPE=InnoDB;

CREATE TABLE USERPROFILE (
  ID CHAR(38) NOT NULL,
  CSMUSER_ID CHAR(38) NOT NULL,
  CONTEXT_ID CHAR(38) NOT NULL,
  NAME VARCHAR(45) NOT NULL,
  DESCRIPTION TEXT NULL,
  ROLE CHAR(2) NULL,
  PRIMARY KEY(ID, CSMUSER_ID),
  INDEX USERPROFILE_FKIndex1(CONTEXT_ID),
  INDEX USERPROFILE_FKIndex2(CSMUSER_ID),
  FOREIGN KEY(CONTEXT_ID)
    REFERENCES CONTEXT(ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION,
  FOREIGN KEY(CSMUSER_ID)
    REFERENCES CSMUSER(ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION
)
TYPE=InnoDB;


DROP TABLE IF EXISTS `cloudshield`.`role`;
CREATE TABLE  `cloudshield`.`role` (
  `id` char(2) NOT NULL default '',
  `name` varchar(60) default NULL,
  `description` varchar(200) default NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;


CREATE TABLE ALDE (
  ID CHAR(38) NOT NULL,
  CONTEXTID CHAR(38) NULL,
  NAME VARCHAR(60) NULL,
  DESCRIPTION TEXT NULL,
  HOST VARCHAR(100) NULL,
  HOSTSOAP VARCHAR(100) NULL,
  USERNAME VARCHAR(30) NULL,
  USERPASS CHAR(38) NULL,
  PRIMARY KEY(ID)
)
TYPE=InnoDB;

CREATE TABLE ALDECONFIG (
  ID CHAR(38) NOT NULL,
  ALDE_ID CHAR(38) NOT NULL,
  NAME VARCHAR(60) NOT NULL,
  DESCRIPTION TEXT NULL,
  IDENTIFICATION VARCHAR(30) NULL,
  MODE CHAR(1) NOT NULL,
  ATTACKTOLERANCE INTEGER UNSIGNED NULL,
  WAITALERT INTEGER UNSIGNED NULL,
  SAMPLE INTEGER UNSIGNED NULL,
  OLDNET INTEGER UNSIGNED NULL,
  SAFEPOLLMODE INTEGER UNSIGNED NULL,
  OLDBASELINE INTEGER UNSIGNED NULL,
  CURRENTBASELINE INTEGER UNSIGNED NULL,
  BASELINETIME INTEGER UNSIGNED NULL,
  ADJUSTMENTMIN INTEGER UNSIGNED NULL,
  ADJUSTMENTMAX INTEGER UNSIGNED NULL,
  CSMIP VARCHAR(100) NOT NULL,
  CSMPORT INTEGER UNSIGNED NOT NULL,
  PRIMARY KEY(ID),
  INDEX ALDECONFIG_FKIndex1(ALDE_ID)
)
TYPE=InnoDB;
